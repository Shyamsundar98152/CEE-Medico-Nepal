<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sign Up - CeeMedicoNepal</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/fevicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/fevicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/fevicon/favicon-16x16.png">
    <link rel="manifest" href="/fevicon/site.webmanifest">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      background: linear-gradient(135deg, #667eea, #764ba2);
      font-family: 'Segoe UI', sans-serif;
      min-height: 100vh;
    }
    
    /* Header Styles */
    .header {
      background-color: #fff;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      position: fixed;
      width: 100%;
      top: 0;
      z-index: 1000;
    }
    
    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 5%;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .logo {
      font-size: 24px;
      font-weight: bold;
      color: #333;
      text-decoration: none;
    }
    
    .logo span {
      color: #667eea;
    }
    
    .nav-menu {
      display: flex;
      list-style: none;
    }
    
    .nav-menu li {
      margin-left: 30px;
    }
    
    .nav-menu a {
      text-decoration: none;
      color: #333;
      font-weight: 500;
      transition: color 0.3s;
    }
    
    .nav-menu a:hover {
      color: #667eea;
    }
    
    /* Main Content */
    .main-content {
      padding-top: 80px;
      min-height: calc(100vh - 80px);
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .signup-container {
      background: white;
      padding: 30px;
      border-radius: 15px;
      width: 350px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
      margin: 20px;
    }
    
    .signup-container h2 {
      text-align: center;
      margin-bottom: 20px;
      color: #333;
    }

    input {
      width: 100%;
      padding: 12px;
      margin-top: 8px;
      margin-bottom: 15px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 14px;
    }
    
    .input-group {
      margin-bottom: 5px;
    }

    button {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
    }
    
    .btn-primary {
      background: #667eea;
      color: white;
      margin-bottom: 15px;
    }
    
    .btn-primary:hover {
      background: #556cd6;
    }
    
    .btn-google {
      background: #fff;
      color: #333;
      border: 1px solid #ccc;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 15px;
    }
    
    .btn-google:hover {
      background: #f5f5f5;
    }
    
    .google-icon {
      width: 20px;
      margin-right: 10px;
    }

    .message {
      margin-top: 10px;
      color: red;
      text-align: center;
      font-size: 14px;
    }
    
    .divider {
      display: flex;
      align-items: center;
      margin: 15px 0;
      color: #777;
    }
    
    .divider::before, .divider::after {
      content: "";
      flex: 1;
      border-bottom: 1px solid #ddd;
    }
    
    .divider::before {
      margin-right: 10px;
    }
    
    .divider::after {
      margin-left: 10px;
    }
    
    .login-link {
      text-align: center;
      margin-top: 15px;
      color: #666;
    }
    
    .login-link a {
      color: #667eea;
      text-decoration: none;
    }
    
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
      margin-right: 10px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    @media (max-width: 768px) {
      .header-container {
        padding: 15px 20px;
      }
      
      .nav-menu li {
        margin-left: 15px;
      }
      
      .signup-container {
        width: 90%;
        max-width: 350px;
      }
    }
  </style>
</head>
<body>
  <!-- Header Section -->
  <header class="header">
    <div class="header-container">
      <a href="https://ceemediconepal.xyz" class="logo">Cee<span>MediConePal</span></a>
      <ul class="nav-menu">
        <li><a href="https://ceemediconepal.xyz">Home</a></li>
        <li><a href="https://ceemediconepal.xyz/about">About</a></li>
        <li><a href="https://ceemediconepal.xyz/secure/protected.html">Premium</a></li>
        <li><a href="https://ceemediconepal.xyz/contact">Contact</a></li>
      </ul>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <div class="signup-container">
      <h2>Create Account</h2>
      <div class="input-group">
        <input type="text" id="signupName" placeholder="Full Name" required />
      </div>
      <div class="input-group">
        <input type="email" id="signupEmail" placeholder="Email" required />
      </div>
      <div class="input-group">
        <input type="password" id="signupPassword" placeholder="Password (min. 6 characters)" required minlength="6" />
      </div>
      <div class="input-group">
        <input type="password" id="signupConfirmPassword" placeholder="Confirm Password" required />
      </div>
      <button class="btn-primary" id="signupBtn" onclick="signup()">
        <span id="signupBtnText">Sign Up</span>
      </button>
      
      <div class="divider">OR</div>
      
      <button class="btn-google" id="googleBtn" onclick="signInWithGoogle()">
        <img src="img/google-icon.png" alt="Google" class="google-icon">
        <span id="googleBtnText">Sign up with Google</span>
      </button>
      
      <div class="message" id="message"></div>
      
      <div class="login-link">
        Already have an account? <a href="login.html">Log in</a>
      </div>
    </div>
  </main>

  <!-- Firebase SDKs -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
    import { 
      getAuth, 
      createUserWithEmailAndPassword,
      GoogleAuthProvider,
      signInWithPopup,
      updateProfile
    } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-auth.js";
    import { 
      getFirestore,
      doc,
      setDoc
    } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-firestore.js";

    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyB66MZa0WZk3WPydcjmCDu7P_CE0FD60ug",
      authDomain: "login-2f07b.firebaseapp.com",
      projectId: "login-2f07b",
      storageBucket: "login-2f07b.appspot.com",
      messagingSenderId: "709252763741",
      appId: "1:709252763741:web:b3902697cc9c8b157a7db4",
      measurementId: "G-G7ZY1MJ106"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const provider = new GoogleAuthProvider();

    // Helper function to show loading state
    function setLoading(buttonId, isLoading) {
      const button = document.getElementById(buttonId);
      const buttonText = document.getElementById(`${buttonId}Text`);
      
      if (isLoading) {
        button.disabled = true;
        buttonText.innerHTML = `<span class="loading"></span> Processing...`;
      } else {
        button.disabled = false;
        if (buttonId === 'signupBtn') {
          buttonText.textContent = 'Sign Up';
        } else {
          buttonText.textContent = 'Sign up with Google';
        }
      }
    }

    // Sign up with email and password
    window.signup = async function () {
      const name = document.getElementById("signupName").value.trim();
      const email = document.getElementById("signupEmail").value.trim();
      const password = document.getElementById("signupPassword").value;
      const confirmPassword = document.getElementById("signupConfirmPassword").value;
      const msg = document.getElementById("message");

      // Validate inputs
      if (!name || !email || !password || !confirmPassword) {
        msg.textContent = "Please fill in all fields";
        return;
      }

      if (password !== confirmPassword) {
        msg.textContent = "Passwords don't match";
        return;
      }

      if (password.length < 6) {
        msg.textContent = "Password must be at least 6 characters";
        return;
      }

      setLoading('signupBtn', true);
      msg.textContent = "";

      try {
        // Create user with email/password
        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;
        
        // Update user profile with display name
        await updateProfile(user, {
          displayName: name
        });
        
        // Create user document in Firestore
        await setDoc(doc(db, "users", user.uid), {
          name: name,
          email: email,
          createdAt: new Date(),
          lastLogin: new Date()
        });
        
        msg.style.color = "green";
        msg.textContent = "Signup successful! Redirecting...";
        setTimeout(() => {
          window.location.href = "login.html";
        }, 1500);
      } catch (error) {
        let errorMessage = "Signup failed";
        
        // Handle specific error cases
        if (error.code === "auth/email-already-in-use") {
          errorMessage = "Email already in use";
        } else if (error.code === "auth/invalid-email") {
          errorMessage = "Invalid email address";
        } else if (error.code === "auth/weak-password") {
          errorMessage = "Password is too weak";
        } else {
          errorMessage = error.message;
        }
        
        msg.textContent = errorMessage;
      } finally {
        setLoading('signupBtn', false);
      }
    };
    
    // Sign in with Google
    window.signInWithGoogle = async function() {
      setLoading('googleBtn', true);
      document.getElementById("message").textContent = "";
      
      try {
        const result = await signInWithPopup(auth, provider);
        const credential = GoogleAuthProvider.credentialFromResult(result);
        const token = credential.accessToken;
        const user = result.user;
        
        // Create user document in Firestore for Google sign-in
        await setDoc(doc(db, "users", user.uid), {
          name: user.displayName,
          email: user.email,
          photoURL: user.photoURL,
          provider: "google",
          createdAt: new Date(),
          lastLogin: new Date()
        });
        
        document.getElementById("message").style.color = "green";
        document.getElementById("message").textContent = "Google sign-in successful! Redirecting...";
        setTimeout(() => {
          window.location.href = "login.html";
        }, 1500);
      } catch (error) {
        let errorMessage = "Google sign-in failed";
        
        if (error.code === "auth/account-exists-with-different-credential") {
          errorMessage = "Email already in use with another method";
        } else if (error.code === "auth/popup-closed-by-user") {
          errorMessage = "Sign-in popup was closed";
        } else {
          errorMessage = error.message;
        }
        
        document.getElementById("message").textContent = errorMessage;
      } finally {
        setLoading('googleBtn', false);
      }
    };

    // Add form submission on Enter key
    document.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        signup();
      }
    });
  </script>
  <!-- Ad Popup Notice Box (Side Position) -->
<div id="noticePopup" style="display:none; position:fixed; bottom:20px; right:20px; background:#fff; padding:15px; border:2px solid #0077cc; box-shadow:0 0 15px rgba(0,0,0,0.4); z-index:9999; border-radius:10px; max-width:300px; width:90%; text-align:center;">
  <h3 style="margin:0; font-size:16px; color:#0077cc;">📢 Sponsored Ad</h3>
  <img src="/img/payment-premium.png" alt="Ad Banner" style="width:100%; height:auto; border-radius:5px; margin:10px 0;">
  <p style="margin:10px 0; font-size:14px; color:green;"> After register, contact +9779812240229 Whatsapp for approval!</p>
  <p id="countdown" style="color:#cc0000; font-weight:bold; font-size:13px;">Closing in 10 seconds...</p>
  <button onclick="closeNotice()" style="margin-top:10px; padding:5px 15px; background:#0077cc; color:#fff; border:none; border-radius:5px; font-size:13px;">Close</button>
</div>

<!-- JavaScript for Notice -->
<script>
  let countdownValue = 10;
  let countdownInterval;

  window.addEventListener('load', () => {
    const popup = document.getElementById("noticePopup");
    const countdown = document.getElementById("countdown");

    popup.style.display = "block";

    countdownInterval = setInterval(() => {
      countdownValue--;
      countdown.textContent = `Closing in ${countdownValue} second${countdownValue !== 1 ? 's' : ''}...`;
      if (countdownValue <= 0) {
        clearInterval(countdownInterval);
        closeNotice();
      }
    }, 1000);
  });

  function closeNotice() {
    document.getElementById("noticePopup").style.display = "none";
    clearInterval(countdownInterval);
  }
  import {
  getDatabase,
  ref,
  set
} from "https://www.gstatic.com/firebasejs/11.8.1/firebase-database.js";
  
</script>

</body>
</html>
