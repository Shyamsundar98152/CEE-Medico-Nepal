<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
  import {
    getDatabase,
    ref,
    get
  } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-database.js";
  import {
    getAuth,
    onAuthStateChanged,
    signOut
  } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB66MZa0WZk3WPydcjmCDu7P_CE0FD60ug",
    authDomain: "login-2f07b.firebaseapp.com",
    projectId: "login-2f07b",
    storageBucket: "login-2f07b.appspot.com",
    messagingSenderId: "709252763741",
    appId: "1:709252763741:web:b3902697cc9c8b157a7db4",
    databaseURL: "https://login-2f07b-default-rtdb.asia-southeast1.firebasedatabase.app"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const auth = getAuth(app);

  onAuthStateChanged(auth, async (user) => {
    if (user) {
      const adminRef = ref(db, "admins/" + user.uid);
      const snapshot = await get(adminRef);
      if (snapshot.exists() && snapshot.val() === true) {
        console.log("✅ Admin access granted.");
        // Continue showing admin page
      } else {
        alert("⛔ Access denied. You are not an admin.");
        await signOut(auth);
        window.location.href = "/login.html";
      }
    } else {
      window.location.href = "/login.html";
    }
  });
</script>
